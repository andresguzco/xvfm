[DEBUG] Host name:  gpu132.cluster.local
wandb: Starting wandb agent ğŸ•µï¸
2025-01-27 00:43:44,854 - wandb.wandb_agent - INFO - Running runs: []
2025-01-27 00:43:44,983 - wandb.wandb_agent - INFO - Agent received command: run
2025-01-27 00:43:44,984 - wandb.wandb_agent - INFO - Agent starting run with config:
	batch_size: 1024
	d_layers: 512
	data_path: ../../data/shoppers
	dataset: shoppers
	dim_t: 256
	dropout: 0.3
	log_interval: 50
	lr: 0.01
	n_layers: 5
	num_epochs: 4000
	seed: 42
	task_type: binclass
2025-01-27 00:43:44,994 - wandb.wandb_agent - INFO - About to run command: /usr/bin/env python ../../main.py --batch_size=1024 --d_layers=512 --data_path=../../data/shoppers --dataset=shoppers --dim_t=256 --dropout=0.3 --log_interval=50 --lr=0.01 --n_layers=5 --num_epochs=4000 --seed=42 --task_type=binclass
/h/aguzmanc/miniforge3/envs/eval/lib/python3.11/site-packages/xgboost/core.py:265: FutureWarning: Your system has an old version of glibc (< 2.28). We will stop supporting Linux distros with glibc older than 2.28 after **May 31, 2025**. Please upgrade to a recent Linux distro (with glibc 2.28+) to use future versions of XGBoost.
Note: You have installed the 'manylinux2014' variant of XGBoost. Certain features such as GPU algorithms or federated learning are not available. To use these features, please upgrade to a recent Linux distro with glibc 2.28+, and install the 'manylinux_2_28' variant.
  warnings.warn(
2025-01-27 00:43:50,012 - wandb.wandb_agent - INFO - Running runs: ['3qugl1en']
wandb: Currently logged in as: andresguzco. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.19.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /fs01/home/aguzmanc/xvfm/src/sweeps/wandb/run-20250127_004354-3qugl1en
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run cosmic-sweep-8
wandb: â­ï¸ View project at https://wandb.ai/andresguzco/XVFM
wandb: ğŸ§¹ View sweep at https://wandb.ai/andresguzco/XVFM/sweeps/aojvbd3l
wandb: ğŸš€ View run at https://wandb.ai/andresguzco/XVFM/runs/3qugl1en
Number of parameters: 1307724
Training parameters: {'num_epochs': 4000, 'batch_size': 1024, 'lr': 0.01, 'integration_steps': 100, 'sigma': 0.01, 'dataset': 'shoppers', 'log_interval': 50, 'seed': 42, 'results_dir': 'results', 'd_layers': 512, 'n_layers': 5, 'dropout': 0.3, 'dim_t': 256, 'data_path': '../../data/shoppers', 'task_type': 'binclass', 'arch': [512, 512, 512, 512, 512], 'num_feat': 10, 'classes': [10, 8, 13, 9, 20, 3, 2], 'd_in': 75}
Epoch [1/4000]: Loss: [19007.7658]
Epoch [2/4000]: Loss: [226.4497]
Epoch [3/4000]: Loss: [169.4984]
Epoch [4/4000]: Loss: [140.0206]
Epoch [5/4000]: Loss: [132.1563]
Epoch [6/4000]: Loss: [131.3577]
Epoch [7/4000]: Loss: [133.2377]
Epoch [8/4000]: Loss: [130.8119]
Epoch [9/4000]: Loss: [135.1800]
Epoch [10/4000]: Loss: [138.5765]
Epoch [11/4000]: Loss: [131.7735]
Epoch [12/4000]: Loss: [128.8917]
Epoch [13/4000]: Loss: [136.0887]
Epoch [14/4000]: Loss: [133.2847]
Epoch [15/4000]: Loss: [137.5096]
Epoch [16/4000]: Loss: [135.4534]
Epoch [17/4000]: Loss: [132.2470]
Epoch [18/4000]: Loss: [137.1525]
Epoch [19/4000]: Loss: [130.8745]
Epoch [20/4000]: Loss: [132.8323]
Epoch [21/4000]: Loss: [131.4306]
Epoch [22/4000]: Loss: [133.8791]
Epoch [23/4000]: Loss: [126.8523]
Epoch [24/4000]: Loss: [134.1695]
Epoch [25/4000]: Loss: [131.5140]
Epoch [26/4000]: Loss: [137.5526]
Epoch [27/4000]: Loss: [127.5391]
Epoch [28/4000]: Loss: [132.8142]
Epoch [29/4000]: Loss: [138.2081]
Epoch [30/4000]: Loss: [132.8325]
Epoch [31/4000]: Loss: [133.3573]
Epoch [32/4000]: Loss: [131.0181]
Epoch [33/4000]: Loss: [128.5380]
Epoch [34/4000]: Loss: [132.2830]
Epoch [35/4000]: Loss: [130.4700]
Epoch [36/4000]: Loss: [135.0557]
Epoch [37/4000]: Loss: [135.6574]
Epoch [38/4000]: Loss: [128.4856]
Epoch [39/4000]: Loss: [130.2466]
Epoch [40/4000]: Loss: [130.5661]
Epoch [41/4000]: Loss: [132.2126]
Epoch [42/4000]: Loss: [134.4752]
Epoch [43/4000]: Loss: [133.2943]
Epoch [44/4000]: Loss: [130.0707]
Epoch [45/4000]: Loss: [139.3169]
Epoch [46/4000]: Loss: [135.5656]
Epoch [47/4000]: Loss: [132.1822]
Epoch [48/4000]: Loss: [129.6298]
Epoch [49/4000]: Loss: [135.4456]
Epoch [50/4000]: Loss: [135.2782]
Epoch [51/4000]: Loss: [132.3432]
Epoch [52/4000]: Loss: [132.2094]
Epoch [53/4000]: Loss: [132.1566]
Epoch [54/4000]: Loss: [130.7402]
Epoch [55/4000]: Loss: [131.6862]
Epoch [56/4000]: Loss: [133.2428]
Epoch [57/4000]: Loss: [128.2212]
Epoch [58/4000]: Loss: [126.8512]
Epoch [59/4000]: Loss: [134.6933]
Epoch [60/4000]: Loss: [129.6001]
Epoch [61/4000]: Loss: [128.6170]
Epoch [62/4000]: Loss: [131.6921]
Epoch [63/4000]: Loss: [131.6373]
Epoch [64/4000]: Loss: [130.9215]
Epoch [65/4000]: Loss: [130.7290]
Epoch [66/4000]: Loss: [131.9455]
Epoch [67/4000]: Loss: [134.7179]
Epoch [68/4000]: Loss: [132.4777]
Epoch [69/4000]: Loss: [135.4048]
Epoch [70/4000]: Loss: [134.5680]
Epoch [71/4000]: Loss: [131.1829]
Epoch [72/4000]: Loss: [134.7595]
Epoch [73/4000]: Loss: [131.5840]
Epoch [74/4000]: Loss: [135.5727]
Epoch [75/4000]: Loss: [133.3746]
Epoch [76/4000]: Loss: [132.2866]
Epoch [77/4000]: Loss: [133.5773]
Epoch [78/4000]: Loss: [133.4519]
Epoch [79/4000]: Loss: [132.3062]
Epoch [80/4000]: Loss: [130.4894]
Epoch [81/4000]: Loss: [131.4290]
Epoch [82/4000]: Loss: [131.0851]
Epoch [83/4000]: Loss: [132.0505]
Epoch [84/4000]: Loss: [136.0131]
Epoch [85/4000]: Loss: [131.3574]
Epoch [86/4000]: Loss: [134.9668]
Epoch [87/4000]: Loss: [132.3111]
Epoch [88/4000]: Loss: [133.6822]
Epoch [89/4000]: Loss: [130.4669]
Epoch [90/4000]: Loss: [135.4118]
Epoch [91/4000]: Loss: [132.8802]
Epoch [92/4000]: Loss: [135.2705]
Epoch [93/4000]: Loss: [135.0487]
Epoch [94/4000]: Loss: [127.1360]
Epoch [95/4000]: Loss: [135.1273]
Epoch [96/4000]: Loss: [132.7905]
Epoch [97/4000]: Loss: [130.7101]
Epoch [98/4000]: Loss: [130.3719]
Epoch [99/4000]: Loss: [132.7143]
Epoch [100/4000]: Loss: [133.4975]
Epoch [101/4000]: Loss: [134.6160]
Epoch [102/4000]: Loss: [132.7400]
Epoch [103/4000]: Loss: [132.0237]
Epoch [104/4000]: Loss: [128.3073]
Epoch [105/4000]: Loss: [134.8968]
Epoch [106/4000]: Loss: [132.9363]
Epoch [107/4000]: Loss: [132.3747]
Epoch [108/4000]: Loss: [134.4134]
Epoch [109/4000]: Loss: [129.2329]
Epoch [110/4000]: Loss: [135.5436]
Epoch [111/4000]: Loss: [134.3127]
Epoch [112/4000]: Loss: [130.1132]
Epoch [113/4000]: Loss: [131.5130]
Epoch [114/4000]: Loss: [133.5534]
Epoch [115/4000]: Loss: [134.1560]
Epoch [116/4000]: Loss: [133.7605]
Epoch [117/4000]: Loss: [132.7985]
Epoch [118/4000]: Loss: [128.9776]
Epoch [119/4000]: Loss: [129.1272]
Epoch [120/4000]: Loss: [130.0380]
Epoch [121/4000]: Loss: [131.8278]
Epoch [122/4000]: Loss: [134.7412]
Epoch [123/4000]: Loss: [131.4929]
Epoch [124/4000]: Loss: [133.6514]
Epoch [125/4000]: Loss: [129.8563]
Epoch [126/4000]: Loss: [135.1924]
Epoch [127/4000]: Loss: [132.1607]
Epoch [128/4000]: Loss: [132.5041]
Epoch [129/4000]: Loss: [132.2720]
Epoch [130/4000]: Loss: [133.2960]
Epoch [131/4000]: Loss: [129.5735]
Epoch [132/4000]: Loss: [127.7789]
Epoch [133/4000]: Loss: [131.1693]
Epoch [134/4000]: Loss: [129.2456]
Epoch [135/4000]: Loss: [135.5552]
Epoch [136/4000]: Loss: [127.9276]
Epoch [137/4000]: Loss: [132.9818]
Epoch [138/4000]: Loss: [130.7467]
Epoch [139/4000]: Loss: [128.3408]
Epoch [140/4000]: Loss: [131.1366]
Epoch [141/4000]: Loss: [127.4253]
Epoch [142/4000]: Loss: [131.0012]
Epoch [143/4000]: Loss: [131.7890]
Epoch [144/4000]: Loss: [130.0051]
Epoch [145/4000]: Loss: [133.4585]
Epoch [146/4000]: Loss: [133.5013]
Epoch [147/4000]: Loss: [131.3841]
Epoch [148/4000]: Loss: [134.2807]
Epoch [149/4000]: Loss: [136.2780]
Epoch [150/4000]: Loss: [131.5388]
Epoch [151/4000]: Loss: [134.2378]
Epoch [152/4000]: Loss: [130.0705]
Epoch [153/4000]: Loss: [129.8373]
Epoch [154/4000]: Loss: [133.9013]
Epoch [155/4000]: Loss: [132.5506]
Epoch [156/4000]: Loss: [134.5190]
Epoch [157/4000]: Loss: [129.8020]
Epoch [158/4000]: Loss: [134.4929]
Epoch [159/4000]: Loss: [134.7637]
Epoch [160/4000]: Loss: [133.9446]
Epoch [161/4000]: Loss: [135.2512]
Epoch [162/4000]: Loss: [134.5533]
Epoch [163/4000]: Loss: [137.1776]
Epoch [164/4000]: Loss: [134.4719]
Epoch [165/4000]: Loss: [131.9995]
Epoch [166/4000]: Loss: [129.6223]
Epoch [167/4000]: Loss: [128.6525]
Epoch [168/4000]: Loss: [130.5880]
Epoch [169/4000]: Loss: [128.1388]
Epoch [170/4000]: Loss: [123.7952]
Epoch [171/4000]: Loss: [135.2553]
Epoch [172/4000]: Loss: [131.9294]
Epoch [173/4000]: Loss: [134.0871]
Epoch [174/4000]: Loss: [133.2578]
Epoch [175/4000]: Loss: [129.5287]
Epoch [176/4000]: Loss: [135.6176]
Epoch [177/4000]: Loss: [134.1040]
Epoch [178/4000]: Loss: [135.6735]
Epoch [179/4000]: Loss: [133.7464]
Epoch [180/4000]: Loss: [133.0940]
Epoch [181/4000]: Loss: [128.4404]
Epoch [182/4000]: Loss: [131.5175]
Epoch [183/4000]: Loss: [130.6174]
Epoch [184/4000]: Loss: [136.2209]
Epoch [185/4000]: Loss: [134.5385]
Epoch [186/4000]: Loss: [134.4079]
Epoch [187/4000]: Loss: [128.4291]
Epoch [188/4000]: Loss: [133.5180]
Epoch [189/4000]: Loss: [136.5719]
Epoch [190/4000]: Loss: [134.5379]
Epoch [191/4000]: Loss: [134.3307]
Epoch [192/4000]: Loss: [129.4220]
Epoch [193/4000]: Loss: [131.8153]
Epoch [194/4000]: Loss: [128.9816]
Epoch [195/4000]: Loss: [125.2904]
Epoch [196/4000]: Loss: [130.8664]
Epoch [197/4000]: Loss: [130.1603]
Epoch [198/4000]: Loss: [132.3981]
Epoch [199/4000]: Loss: [132.6297]
Epoch [200/4000]: Loss: [133.5733]
Epoch [201/4000]: Loss: [134.1029]
Epoch [202/4000]: Loss: [138.1807]
Epoch [203/4000]: Loss: [130.7867]
Epoch [204/4000]: Loss: [132.9338]
Epoch [205/4000]: Loss: [134.6888]
Epoch [206/4000]: Loss: [133.6491]
Epoch [207/4000]: Loss: [130.5633]
Epoch [208/4000]: Loss: [132.4063]
Epoch [209/4000]: Loss: [134.7169]
Epoch [210/4000]: Loss: [134.4647]
Epoch [211/4000]: Loss: [129.8130]
Epoch [212/4000]: Loss: [133.8019]
Epoch [213/4000]: Loss: [133.4545]
Epoch [214/4000]: Loss: [132.5325]
Epoch [215/4000]: Loss: [133.1968]
Epoch [216/4000]: Loss: [128.3612]
Epoch [217/4000]: Loss: [132.0117]
Epoch [218/4000]: Loss: [131.8903]
Epoch [219/4000]: Loss: [133.1876]
Epoch [220/4000]: Loss: [129.4361]
Epoch [221/4000]: Loss: [134.0965]
Epoch [222/4000]: Loss: [134.5387]
Epoch [223/4000]: Loss: [128.3580]
Epoch [224/4000]: Loss: [131.4922]
Epoch [225/4000]: Loss: [130.5329]
Epoch [226/4000]: Loss: [133.7422]
Epoch [227/4000]: Loss: [132.5225]
Epoch [228/4000]: Loss: [127.6721]
Epoch [229/4000]: Loss: [134.1823]
Epoch [230/4000]: Loss: [129.9475]
Epoch [231/4000]: Loss: [131.5048]
Epoch [232/4000]: Loss: [131.6993]
Epoch [233/4000]: Loss: [129.8342]
Epoch [234/4000]: Loss: [129.0242]
Epoch [235/4000]: Loss: [132.4004]
Epoch [236/4000]: Loss: [130.5714]
Epoch [237/4000]: Loss: [131.0005]
Epoch [238/4000]: Loss: [136.1959]
Epoch [239/4000]: Loss: [133.3495]
Epoch [240/4000]: Loss: [137.0088]
Epoch [241/4000]: Loss: [132.1258]
Epoch [242/4000]: Loss: [130.7261]
Epoch [243/4000]: Loss: [124.7694]
Epoch [244/4000]: Loss: [132.6561]
Epoch [245/4000]: Loss: [134.4433]
Epoch [246/4000]: Loss: [129.7132]
Epoch [247/4000]: Loss: [130.1795]
Epoch [248/4000]: Loss: [134.0527]
Epoch [249/4000]: Loss: [131.1514]
Epoch [250/4000]: Loss: [129.0708]
Epoch [251/4000]: Loss: [139.2923]
Epoch [252/4000]: Loss: [132.9655]
Epoch [253/4000]: Loss: [130.2722]
Traceback (most recent call last):
  File "/fs01/home/aguzmanc/xvfm/src/sweeps/../../main.py", line 152, in <module>
    main(args)
  File "/fs01/home/aguzmanc/xvfm/src/sweeps/../../main.py", line 102, in main
    train(dataloader, test_data, flow_model, criterion, optimizer, 
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/fs01/home/aguzmanc/xvfm/src/sweeps/../../main.py", line 143, in train
    scores = evaluate(args, model, test_data, savedir, epoch + 1, flag, device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/fs01/home/aguzmanc/xvfm/xvfm/utils.py", line 57, in evaluate
    scores = get_performance(gen, test, args, plotting)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/fs01/home/aguzmanc/xvfm/xvfm/eval.py", line 85, in get_performance
    alpha, beta = get_quality(test_oh.cpu().numpy(), syn_oh.cpu().numpy())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/fs01/home/aguzmanc/xvfm/xvfm/eval.py", line 165, in get_quality
    qual_res = quality_evaluator.evaluate(rloader, sloader)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pydantic/decorator.py", line 40, in pydantic.decorator.validate_arguments.validate.wrapper_function
    from contextlib import _GeneratorContextManager
  File "pydantic/decorator.py", line 134, in pydantic.decorator.ValidatedFunction.call
    
  File "pydantic/decorator.py", line 206, in pydantic.decorator.ValidatedFunction.execute
    
  File "/h/aguzmanc/miniforge3/envs/eval/lib/python3.11/site-packages/synthcity/metrics/eval_statistical.py", line 60, in evaluate
    results = self._evaluate(X_gt, X_syn)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pydantic/decorator.py", line 40, in pydantic.decorator.validate_arguments.validate.wrapper_function
    from contextlib import _GeneratorContextManager
  File "pydantic/decorator.py", line 134, in pydantic.decorator.ValidatedFunction.call
    
  File "pydantic/decorator.py", line 206, in pydantic.decorator.ValidatedFunction.execute
    
  File "/h/aguzmanc/miniforge3/envs/eval/lib/python3.11/site-packages/synthcity/metrics/eval_statistical.py", line 720, in _evaluate
    oneclass_model = self._get_oneclass_model(X_)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/h/aguzmanc/miniforge3/envs/eval/lib/python3.11/site-packages/synthcity/metrics/core/metric.py", line 119, in _get_oneclass_model
    return load_from_file(cache_file)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/h/aguzmanc/miniforge3/envs/eval/lib/python3.11/site-packages/synthcity/utils/serialization.py", line 158, in load_from_file
    with open(path, "rb") as f:
         ^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'workspace/sc_metric_cache_model_oneclass_17677478246632158771_3.11.11.bkp'
2025-01-27 00:58:51,637 - wandb.wandb_agent - INFO - Cleaning up finished run: 3qugl1en
wandb: - 0.036 MB of 0.036 MB uploadedwandb: 
wandb: Run history:
wandb:  accuracy â–â–â–â–â–
wandb:     alpha â–ˆâ–‚â–‚â–‚â–â–‚â–â–‚â–‚â–‚â–â–‚â–‚â–‚â–‚â–‚â–â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–‚â–‚â–â–â–‚â–‚â–‚â–â–‚â–‚â–â–â–‚
wandb:      beta â–â–†â–‡â–†â–†â–‡â–‡â–ˆâ–†â–†â–‡â–‡â–‡â–‡â–‡â–†â–†â–†â–‡â–‡â–†â–‡â–‡â–‡â–†â–†â–ˆâ–†â–ˆâ–†â–‡â–†â–ˆâ–‡â–†â–†â–†â–†â–†â–†
wandb: binary_f1 â–â–â–â–â–
wandb: detection â–â–†â–†â–†â–†â–…â–†â–…â–…â–‡â–†â–ƒâ–„â–†â–„â–‡â–…â–‡â–…â–…â–„â–‡â–…â–ƒâ–…â–ˆâ–†â–…â–†â–ƒâ–†â–†â–†â–„â–†â–†â–…â–‡â–…â–…
wandb:      loss â–ˆâ–â–â–â–‚â–â–â–‚â–â–â–â–‚â–â–‚â–‚â–â–â–‚â–â–‚â–â–â–â–‚â–â–‚â–â–â–â–‚â–â–â–â–â–â–â–â–‚â–â–
wandb:   quality â–â–ˆâ–ˆâ–ˆâ–ˆâ–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–‡â–ˆâ–‡â–ˆâ–‡â–‡â–ˆâ–ˆâ–ˆâ–‡â–ˆâ–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–ˆâ–ˆâ–ˆ
wandb:   roc_auc â–ƒâ–ˆâ–ƒâ–â–…
wandb:     shape â–â–‡â–ˆâ–ˆâ–ˆâ–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–‡â–ˆâ–‡â–ˆâ–‡â–†â–ˆâ–ˆâ–‡â–‡â–ˆâ–‡â–ˆâ–‡â–ˆâ–ˆâ–ˆâ–‡â–‡â–ˆâ–‡â–ˆ
wandb:     trend â–â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–‡â–ˆâ–‡â–ˆâ–‡â–ˆâ–‡â–ˆâ–‡â–ˆâ–ˆâ–ˆâ–‡â–ˆâ–‡â–‡â–ˆâ–ˆâ–‡â–ˆâ–ˆâ–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–ˆâ–‡â–ˆâ–ˆ
wandb: 
wandb: Run summary:
wandb:  accuracy 0.85483
wandb:     alpha 0.56415
wandb:      beta 0.32803
wandb: binary_f1 0.0
wandb: detection 0.37294
wandb:      loss 132.96551
wandb:   quality 0.78495
wandb:   roc_auc 0.54754
wandb:     shape 0.63242
wandb:     trend 0.93747
wandb: 
wandb: ğŸš€ View run cosmic-sweep-8 at: https://wandb.ai/andresguzco/XVFM/runs/3qugl1en
wandb: â­ï¸ View project at: https://wandb.ai/andresguzco/XVFM
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20250127_004354-3qugl1en/logs
wandb: Terminating and syncing runs. Press ctrl-c to kill.
