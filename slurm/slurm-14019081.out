Wed Nov 27 11:06:21 EST 2024: Job 14019081 is allocated resources.
Inside slurm_launcher.slrm (/var/spool/slurmd/job14019081/slurm_script). received arguments: main.py --loss_fn Gaussian --dataset mnist --learned_structure scalar
cuda
Number of parameters: 166
Training parameters: {'num_epochs': 10, 'batch_size': 256, 'lr': 0.001, 'loss_fn': 'Gaussian', 'learn_sigma': True, 'learned_structure': 'scalar', 'int_method': 'euler', 'integration_steps': 100, 'sigma': 0.1, 'save_model': False, 'dataset': 'mnist', 'log_interval': 1}
  0%|          | 0/2350 [00:00<?, ?it/s]  0%|          | 1/2350 [00:01<58:38,  1.50s/it]  0%|          | 2/2350 [00:01<32:56,  1.19it/s]  0%|          | 3/2350 [00:02<24:42,  1.58it/s]  0%|          | 4/2350 [00:02<20:47,  1.88it/s]  0%|          | 5/2350 [00:03<18:37,  2.10it/s]  0%|          | 6/2350 [00:03<17:18,  2.26it/s]  0%|          | 7/2350 [00:03<16:27,  2.37it/s]  0%|          | 8/2350 [00:04<15:56,  2.45it/s]  0%|          | 9/2350 [00:04<15:37,  2.50it/s]  0%|          | 10/2350 [00:04<15:22,  2.54it/s]  0%|          | 11/2350 [00:05<15:10,  2.57it/s]  1%|          | 12/2350 [00:05<15:01,  2.59it/s]  1%|          | 13/2350 [00:06<14:55,  2.61it/s]  1%|          | 14/2350 [00:06<14:50,  2.62it/s]  1%|          | 15/2350 [00:06<14:47,  2.63it/s]  1%|          | 16/2350 [00:07<14:45,  2.64it/s]  1%|          | 17/2350 [00:07<14:49,  2.62it/s]  1%|          | 18/2350 [00:07<14:46,  2.63it/s]  1%|          | 19/2350 [00:08<14:44,  2.64it/s]  1%|          | 20/2350 [00:08<14:43,  2.64it/s]  1%|          | 21/2350 [00:09<14:41,  2.64it/s]  1%|          | 22/2350 [00:09<14:40,  2.65it/s]  1%|          | 23/2350 [00:09<14:39,  2.65it/s]  1%|          | 24/2350 [00:10<14:42,  2.64it/s]  1%|          | 25/2350 [00:10<14:41,  2.64it/s]  1%|          | 26/2350 [00:10<14:41,  2.64it/s]  1%|          | 27/2350 [00:11<14:40,  2.64it/s]  1%|          | 28/2350 [00:11<14:39,  2.64it/s]  1%|          | 29/2350 [00:12<14:39,  2.64it/s]  1%|â–         | 30/2350 [00:12<14:42,  2.63it/s]  1%|â–         | 31/2350 [00:12<14:42,  2.63it/s]  1%|â–         | 32/2350 [00:13<14:40,  2.63it/s]  1%|â–         | 33/2350 [00:13<14:39,  2.63it/s]  1%|â–         | 34/2350 [00:14<14:40,  2.63it/s]  1%|â–         | 35/2350 [00:14<14:39,  2.63it/s]  2%|â–         | 36/2350 [00:14<14:37,  2.64it/s]  2%|â–         | 37/2350 [00:15<14:36,  2.64it/s]  2%|â–         | 38/2350 [00:15<14:36,  2.64it/s]  2%|â–         | 39/2350 [00:15<14:35,  2.64it/s]  2%|â–         | 40/2350 [00:16<14:38,  2.63it/s]  2%|â–         | 41/2350 [00:16<14:37,  2.63it/s]  2%|â–         | 42/2350 [00:17<14:35,  2.64it/s]  2%|â–         | 43/2350 [00:17<14:33,  2.64it/s]  2%|â–         | 44/2350 [00:17<14:32,  2.64it/s]  2%|â–         | 45/2350 [00:18<14:26,  2.66it/s]  2%|â–         | 46/2350 [00:18<14:26,  2.66it/s]  2%|â–         | 47/2350 [00:18<14:28,  2.65it/s]  2%|â–         | 48/2350 [00:19<14:28,  2.65it/s]  2%|â–         | 49/2350 [00:19<14:29,  2.65it/s]  2%|â–         | 50/2350 [00:20<14:29,  2.64it/s]  2%|â–         | 51/2350 [00:20<14:29,  2.64it/s]  2%|â–         | 52/2350 [00:20<14:30,  2.64it/s]  2%|â–         | 53/2350 [00:21<14:33,  2.63it/s]  2%|â–         | 54/2350 [00:21<14:33,  2.63it/s]  2%|â–         | 55/2350 [00:21<14:32,  2.63it/s]  2%|â–         | 56/2350 [00:22<14:31,  2.63it/s]  2%|â–         | 57/2350 [00:22<14:30,  2.63it/s]  2%|â–         | 58/2350 [00:23<14:30,  2.63it/s]  3%|â–Ž         | 59/2350 [00:23<14:29,  2.63it/s]  3%|â–Ž         | 60/2350 [00:23<14:29,  2.63it/s]  3%|â–Ž         | 61/2350 [00:24<14:29,  2.63it/s]  3%|â–Ž         | 62/2350 [00:24<14:28,  2.63it/s]  3%|â–Ž         | 63/2350 [00:25<14:28,  2.63it/s]  3%|â–Ž         | 64/2350 [00:25<14:27,  2.63it/s]  3%|â–Ž         | 65/2350 [00:25<14:26,  2.64it/s]  3%|â–Ž         | 66/2350 [00:26<14:26,  2.64it/s]  3%|â–Ž         | 67/2350 [00:26<14:26,  2.64it/s]  3%|â–Ž         | 68/2350 [00:26<14:27,  2.63it/s]  3%|â–Ž         | 69/2350 [00:27<14:28,  2.63it/s]  3%|â–Ž         | 70/2350 [00:27<14:26,  2.63it/s]  3%|â–Ž         | 71/2350 [00:28<14:25,  2.63it/s]  3%|â–Ž         | 72/2350 [00:28<14:24,  2.64it/s]  3%|â–Ž         | 73/2350 [00:28<14:23,  2.64it/s]  3%|â–Ž         | 74/2350 [00:29<14:22,  2.64it/s]  3%|â–Ž         | 75/2350 [00:29<14:22,  2.64it/s]  3%|â–Ž         | 76/2350 [00:29<14:25,  2.63it/s]  3%|â–Ž         | 77/2350 [00:30<14:25,  2.63it/s]  3%|â–Ž         | 78/2350 [00:30<14:23,  2.63it/s]  3%|â–Ž         | 79/2350 [00:31<14:22,  2.63it/s]  3%|â–Ž         | 80/2350 [00:31<14:21,  2.63it/s]  3%|â–Ž         | 81/2350 [00:31<14:20,  2.64it/s]  3%|â–Ž         | 82/2350 [00:32<14:20,  2.64it/s]  4%|â–Ž         | 83/2350 [00:32<14:19,  2.64it/s]  4%|â–Ž         | 84/2350 [00:32<14:19,  2.64it/s]  4%|â–Ž         | 85/2350 [00:33<14:18,  2.64it/s]  4%|â–Ž         | 86/2350 [00:33<14:17,  2.64it/s]  4%|â–Ž         | 87/2350 [00:34<14:17,  2.64it/s]  4%|â–Ž         | 88/2350 [00:34<14:17,  2.64it/s]  4%|â–         | 89/2350 [00:34<14:16,  2.64it/s]  4%|â–         | 90/2350 [00:35<14:16,  2.64it/s]  4%|â–         | 91/2350 [00:35<14:15,  2.64it/s]  4%|â–         | 92/2350 [00:36<14:19,  2.63it/s]  4%|â–         | 93/2350 [00:36<14:18,  2.63it/s]  4%|â–         | 94/2350 [00:36<14:17,  2.63it/s]  4%|â–         | 95/2350 [00:37<14:15,  2.64it/s]  4%|â–         | 96/2350 [00:37<14:14,  2.64it/s]  4%|â–         | 97/2350 [00:37<14:12,  2.64it/s]  4%|â–         | 98/2350 [00:38<14:12,  2.64it/s]  4%|â–         | 99/2350 [00:38<14:13,  2.64it/s]  4%|â–         | 100/2350 [00:39<14:13,  2.64it/s]  4%|â–         | 101/2350 [00:39<14:12,  2.64it/s]  4%|â–         | 102/2350 [00:39<14:12,  2.64it/s]  4%|â–         | 103/2350 [00:40<14:11,  2.64it/s]  4%|â–         | 104/2350 [00:40<14:11,  2.64it/s]  4%|â–         | 105/2350 [00:40<14:10,  2.64it/s]  5%|â–         | 106/2350 [00:41<14:10,  2.64it/s]  5%|â–         | 107/2350 [00:41<14:09,  2.64it/s]  5%|â–         | 108/2350 [00:42<14:09,  2.64it/s]  5%|â–         | 109/2350 [00:42<14:09,  2.64it/s]  5%|â–         | 110/2350 [00:42<14:08,  2.64it/s]  5%|â–         | 111/2350 [00:43<14:07,  2.64it/s]  5%|â–         | 112/2350 [00:43<14:05,  2.65it/s]  5%|â–         | 113/2350 [00:43<14:04,  2.65it/s]  5%|â–         | 114/2350 [00:44<14:04,  2.65it/s]  5%|â–         | 115/2350 [00:44<14:05,  2.64it/s]  5%|â–         | 116/2350 [00:45<14:07,  2.64it/s]  5%|â–         | 117/2350 [00:45<14:07,  2.64it/s]  5%|â–Œ         | 118/2350 [00:45<14:06,  2.64it/s]  5%|â–Œ         | 119/2350 [00:46<14:05,  2.64it/s]  5%|â–Œ         | 120/2350 [00:46<14:05,  2.64it/s]  5%|â–Œ         | 121/2350 [00:46<14:05,  2.64it/s]  5%|â–Œ         | 122/2350 [00:47<14:02,  2.64it/s]  5%|â–Œ         | 123/2350 [00:47<14:02,  2.64it/s]  5%|â–Œ         | 124/2350 [00:48<14:02,  2.64it/s]  5%|â–Œ         | 125/2350 [00:48<14:02,  2.64it/s]  5%|â–Œ         | 126/2350 [00:48<14:03,  2.64it/s]  5%|â–Œ         | 127/2350 [00:49<14:02,  2.64it/s]  5%|â–Œ         | 128/2350 [00:49<14:01,  2.64it/s]  5%|â–Œ         | 129/2350 [00:50<14:00,  2.64it/s]  6%|â–Œ         | 130/2350 [00:50<14:02,  2.64it/s]  6%|â–Œ         | 131/2350 [00:50<14:01,  2.64it/s]  6%|â–Œ         | 132/2350 [00:51<14:00,  2.64it/s]  6%|â–Œ         | 133/2350 [00:51<14:00,  2.64it/s]  6%|â–Œ         | 134/2350 [00:51<13:59,  2.64it/s]  6%|â–Œ         | 135/2350 [00:52<13:58,  2.64it/s]  6%|â–Œ         | 136/2350 [00:52<13:58,  2.64it/s]  6%|â–Œ         | 137/2350 [00:53<13:58,  2.64it/s]  6%|â–Œ         | 138/2350 [00:53<13:58,  2.64it/s]  6%|â–Œ         | 139/2350 [00:53<13:57,  2.64it/s]  6%|â–Œ         | 140/2350 [00:54<13:57,  2.64it/s]  6%|â–Œ         | 141/2350 [00:54<13:57,  2.64it/s]  6%|â–Œ         | 142/2350 [00:54<13:56,  2.64it/s]  6%|â–Œ         | 143/2350 [00:55<13:56,  2.64it/s]  6%|â–Œ         | 144/2350 [00:55<13:56,  2.64it/s]  6%|â–Œ         | 145/2350 [00:56<13:55,  2.64it/s]  6%|â–Œ         | 146/2350 [00:56<13:55,  2.64it/s]  6%|â–‹         | 147/2350 [00:56<13:55,  2.64it/s]  6%|â–‹         | 148/2350 [00:57<13:54,  2.64it/s]  6%|â–‹         | 149/2350 [00:57<13:54,  2.64it/s]  6%|â–‹         | 150/2350 [00:57<13:53,  2.64it/s]  6%|â–‹         | 151/2350 [00:58<13:53,  2.64it/s]  6%|â–‹         | 152/2350 [00:58<13:53,  2.64it/s]  7%|â–‹         | 153/2350 [00:59<13:52,  2.64it/s]  7%|â–‹         | 154/2350 [00:59<13:52,  2.64it/s]  7%|â–‹         | 155/2350 [00:59<13:52,  2.64it/s]  7%|â–‹         | 156/2350 [01:00<13:51,  2.64it/s]  7%|â–‹         | 157/2350 [01:00<13:50,  2.64it/s]  7%|â–‹         | 158/2350 [01:01<13:50,  2.64it/s]  7%|â–‹         | 159/2350 [01:01<13:53,  2.63it/s]  7%|â–‹         | 160/2350 [01:01<13:52,  2.63it/s]  7%|â–‹         | 161/2350 [01:02<13:51,  2.63it/s]  7%|â–‹         | 162/2350 [01:02<13:50,  2.63it/s]  7%|â–‹         | 163/2350 [01:02<13:49,  2.64it/s]  7%|â–‹         | 164/2350 [01:03<13:49,  2.63it/s]  7%|â–‹         | 165/2350 [01:03<13:48,  2.64it/s]  7%|â–‹         | 166/2350 [01:04<13:47,  2.64it/s]  7%|â–‹         | 167/2350 [01:04<13:46,  2.64it/s]  7%|â–‹         | 168/2350 [01:04<13:45,  2.64it/s]  7%|â–‹         | 169/2350 [01:05<13:45,  2.64it/s]  7%|â–‹         | 170/2350 [01:05<13:46,  2.64it/s]  7%|â–‹         | 171/2350 [01:05<13:47,  2.63it/s]  7%|â–‹         | 172/2350 [01:06<13:46,  2.64it/s]  7%|â–‹         | 173/2350 [01:06<13:45,  2.64it/s]  7%|â–‹         | 174/2350 [01:07<13:41,  2.65it/s]  7%|â–‹         | 175/2350 [01:07<13:41,  2.65it/s]  7%|â–‹         | 176/2350 [01:07<13:40,  2.65it/s]  8%|â–Š         | 177/2350 [01:08<13:39,  2.65it/s]  8%|â–Š         | 178/2350 [01:08<13:39,  2.65it/s]  8%|â–Š         | 179/2350 [01:08<13:38,  2.65it/s]  8%|â–Š         | 180/2350 [01:09<13:38,  2.65it/s]  8%|â–Š         | 181/2350 [01:09<13:37,  2.65it/s]  8%|â–Š         | 182/2350 [01:10<13:37,  2.65it/s]  8%|â–Š         | 183/2350 [01:10<13:32,  2.67it/s]  8%|â–Š         | 184/2350 [01:10<13:30,  2.67it/s]  8%|â–Š         | 185/2350 [01:11<13:37,  2.65it/s]  8%|â–Š         | 186/2350 [01:11<13:38,  2.64it/s]  8%|â–Š         | 187/2350 [01:11<13:37,  2.64it/s]  8%|â–Š         | 188/2350 [01:12<13:38,  2.64it/s]  8%|â–Š         | 189/2350 [01:12<13:38,  2.64it/s]  8%|â–Š         | 190/2350 [01:13<13:37,  2.64it/s]  8%|â–Š         | 191/2350 [01:13<13:37,  2.64it/s]  8%|â–Š         | 192/2350 [01:13<13:36,  2.64it/s]  8%|â–Š         | 193/2350 [01:14<13:35,  2.64it/s]  8%|â–Š         | 194/2350 [01:14<13:35,  2.64it/s]  8%|â–Š         | 195/2350 [01:15<13:35,  2.64it/s]  8%|â–Š         | 196/2350 [01:15<13:35,  2.64it/s]  8%|â–Š         | 197/2350 [01:15<13:35,  2.64it/s]  8%|â–Š         | 198/2350 [01:16<13:35,  2.64it/s]  8%|â–Š         | 199/2350 [01:16<13:35,  2.64it/s]  9%|â–Š         | 200/2350 [01:16<13:35,  2.64it/s]  9%|â–Š         | 201/2350 [01:17<13:34,  2.64it/s]  9%|â–Š         | 202/2350 [01:17<13:33,  2.64it/s]  9%|â–Š         | 203/2350 [01:18<13:32,  2.64it/s]  9%|â–Š         | 204/2350 [01:18<13:32,  2.64it/s]  9%|â–Š         | 205/2350 [01:18<13:32,  2.64it/s]  9%|â–‰         | 206/2350 [01:19<13:32,  2.64it/s]  9%|â–‰         | 207/2350 [01:19<13:31,  2.64it/s]  9%|â–‰         | 208/2350 [01:19<13:31,  2.64it/s]  9%|â–‰         | 209/2350 [01:20<13:31,  2.64it/s]  9%|â–‰         | 210/2350 [01:20<13:31,  2.64it/s]  9%|â–‰         | 211/2350 [01:21<13:30,  2.64it/s]  9%|â–‰         | 212/2350 [01:21<13:29,  2.64it/s]  9%|â–‰         | 213/2350 [01:21<13:29,  2.64it/s]  9%|â–‰         | 214/2350 [01:22<13:28,  2.64it/s]  9%|â–‰         | 215/2350 [01:22<13:28,  2.64it/s]  9%|â–‰         | 216/2350 [01:22<13:29,  2.64it/s]  9%|â–‰         | 217/2350 [01:23<13:30,  2.63it/s]  9%|â–‰         | 218/2350 [01:23<13:29,  2.63it/s]  9%|â–‰         | 219/2350 [01:24<13:28,  2.64it/s]  9%|â–‰         | 220/2350 [01:24<13:27,  2.64it/s]  9%|â–‰         | 221/2350 [01:24<13:27,  2.64it/s]  9%|â–‰         | 222/2350 [01:25<13:26,  2.64it/s]  9%|â–‰         | 223/2350 [01:25<13:25,  2.64it/s] 10%|â–‰         | 224/2350 [01:26<13:24,  2.64it/s] 10%|â–‰         | 225/2350 [01:26<13:22,  2.65it/s] 10%|â–‰         | 226/2350 [01:26<13:22,  2.65it/s] 10%|â–‰         | 227/2350 [01:27<13:22,  2.65it/s] 10%|â–‰         | 228/2350 [01:27<13:22,  2.64it/s] 10%|â–‰         | 229/2350 [01:27<13:22,  2.64it/s] 10%|â–‰         | 230/2350 [01:28<13:21,  2.64it/s] 10%|â–‰         | 231/2350 [01:28<13:21,  2.64it/s] 10%|â–‰         | 232/2350 [01:29<13:20,  2.64it/s] 10%|â–‰         | 233/2350 [01:29<13:20,  2.64it/s] 10%|â–‰         | 234/2350 [01:29<13:20,  2.64it/s] 10%|â–ˆ         | 235/2350 [01:30<12:26,  2.83it/s]Epoch 1, Loss: 746.0541:  10%|â–ˆ         | 235/2350 [01:30<12:26,  2.83it/s]/h/aguzmanc/miniforge3/envs/xvfm/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/h/aguzmanc/miniforge3/envs/xvfm/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=Inception_V3_Weights.IMAGENET1K_V1`. You can also use `weights=Inception_V3_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Downloading: "https://download.pytorch.org/models/inception_v3_google-0cc3c7bd.pth" to /h/aguzmanc/.cache/torch/hub/checkpoints/inception_v3_google-0cc3c7bd.pth

  0%|          | 0.00/104M [00:00<?, ?B/s][A
 19%|â–ˆâ–‰        | 19.5M/104M [00:00<00:00, 203MB/s][A
 38%|â–ˆâ–ˆâ–ˆâ–Š      | 39.9M/104M [00:00<00:00, 209MB/s][A
 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 60.1M/104M [00:00<00:00, 209MB/s][A
 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 80.4M/104M [00:00<00:00, 210MB/s][A
 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 101M/104M [00:00<00:00, 211MB/s] [A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 104M/104M [00:00<00:00, 210MB/s]
Traceback (most recent call last):
  File "/h/aguzmanc/XVFM/main.py", line 162, in <module>
    main(args)
  File "/h/aguzmanc/XVFM/main.py", line 107, in main
    train(dataloader, flow_model, criterion, optimizer, device, savedir, args)
  File "/h/aguzmanc/XVFM/main.py", line 153, in train
    evaluate(args, model, savedir, device, epoch+1)
  File "/fs01/home/aguzmanc/XVFM/data/utils.py", line 76, in evaluate
    fid = calculate_fid(real_images, generated_images)
  File "/fs01/home/aguzmanc/XVFM/data/utils.py", line 24, in calculate_fid
    real_features = get_features(real_images)
  File "/fs01/home/aguzmanc/XVFM/data/utils.py", line 20, in get_features
    features = inception(images).detach()
  File "/h/aguzmanc/miniforge3/envs/xvfm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/h/aguzmanc/miniforge3/envs/xvfm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/h/aguzmanc/miniforge3/envs/xvfm/lib/python3.10/site-packages/torchvision/models/inception.py", line 166, in forward
    x, aux = self._forward(x)
  File "/h/aguzmanc/miniforge3/envs/xvfm/lib/python3.10/site-packages/torchvision/models/inception.py", line 105, in _forward
    x = self.Conv2d_1a_3x3(x)
  File "/h/aguzmanc/miniforge3/envs/xvfm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/h/aguzmanc/miniforge3/envs/xvfm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/h/aguzmanc/miniforge3/envs/xvfm/lib/python3.10/site-packages/torchvision/models/inception.py", line 405, in forward
    x = self.conv(x)
  File "/h/aguzmanc/miniforge3/envs/xvfm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/h/aguzmanc/miniforge3/envs/xvfm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/h/aguzmanc/miniforge3/envs/xvfm/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/h/aguzmanc/miniforge3/envs/xvfm/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
RuntimeError: Given groups=1, weight of size [32, 3, 3, 3], expected input[100, 1, 299, 299] to have 3 channels, but got 1 channels instead
Epoch 1, Loss: 746.0541:  10%|â–ˆ         | 235/2350 [01:37<14:33,  2.42it/s]
